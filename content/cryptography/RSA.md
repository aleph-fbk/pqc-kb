---
date: '2025-06-06T13:19:11+02:00'
draft: true
title: 'RSA'
math: true
---
## The basics: RSA signature

In textbook RSA, only with a private key $d$ can we generate a signature
$$\sigma \leftarrow m^{d}\equiv m \pmod{N}$$
but anyone with the public key $(e,N)$ can verify that
$$\sigma^e \equiv m \pmod{N}$$
The keys are constructed from two random prime numbers $p,q$ such that
$$de\equiv 1 \pmod{\phi(N)}$$
where $\phi(N)=(p-1)(q-1)$ is Euler's totient function for such $N$.

> [!WARNING]
> Anyone gaining knowledge of $p$ or $q$ can recover the private key $d$ by computing either $\gcd(p,N)$ or $\gcd(q,N)$.

{{% details title="Details" closed="true" %}}

There are plenty of ways to [attack RSA](https://crypto.stanford.edu/~dabo/papers/RSA-survey.pdf) in special cases. Even knowing $\phi(N)$ allows computing $e^{-1} \mod \phi(N)$. The above simplification is most relevant for our purpose here.

{{% /details %}}

> [!IMPORTANT]
> The most efficient classical algorithm to factorize an $N$ of length $b$ bits, the GNFS, has complexity approximately
> $$e ^ {3 b^{1/3} \cdot (\log b)^{2/3}}$$
> A 3072-bit RSA public key provides $\approx 128$ bits of security against a classical computer. [[BGGHTZ_22](https://dx.doi.org/10.1109/MSEC.2022.3141918)]

> [!WARNING]
> The most efficient quantum algorithm to factorize an $N$ of length $b$ bits, Shor's algorithm, has complexity approximately
> $$b^3$$
> A 3072-bit RSA public key provides $\approx 34$ bits of security against a quantum computer.

## RSA and Shor's algorithm

> [!NOTE]
> Finding the period of the function $a^k \mod N$ allows recovering the factors of $N$.

{{% details title="Order of group elements" closed="true" %}}

The order of a group element $x$ is the smallest integer $k$ for which $a^k \equiv 1 \mod N$.

If no such $k$ exists, the element is said to have infinite order. If it does, the subset ${a^j} \subseteq G$ is a subgroup of G generated by a, and its order is $k$.

The order of every group element is a divisor of the number of group elements.

The order of the group $G$ is the number of group elements in $G$.

Lagrangeâ€™s theorem: the order of any subgroups of G is a divisor of the order of G itself.


> [!IMPORTANT]
> If $x$ is a non-trivial solution to $x^2-1\equiv 0 \pmod{N}$, then $(x\pm 1)\mid N$.

> [!WARNING]
> The factors of $N$ can be efficiently recovered by $\gcd(N,x\pm 1)$.

Consider the solutions to

$$
\begin{align}
   x^2 & \equiv 1 \pmod{N}  \\
   x^2 - 1^2 & = 0 \pmod{N}   \\
   (x+1)(x-1) & = 0 \pmod{N}    \\
   N & \mid (x+1)(x-1)
\end{align}
$$

${1,-1}$ are solutions for any $N$. There will be other solutions $\neq \pm 1$ when $(x+1)(x-1)$ is divided by $p$ or $q$.

{{% details title="Example" closed="true" %}}

Suppose $p=3, q=7, N=21$. Non-trivial solutions are ${8,-8\equiv 13}$, for which $\gcd(\pm x_i,N)={3,7}$ respectively.

{{% /details %}}

{{% /details %}}